<!---
 General definitions:
 Colors:
 
 white
 black
 navy
 green
 red
 maroon
 purple
 orange
 yellow
 lime
 teal
 lightcyan
 royalblue
 fuchsia
 grey
 silver
 
 default-foreground
 The default color of the foreground.
 
 default-background
 The default color of the background. Usually trasparent.
 
 invalid
 Should never be used, but in case things go wrong with the IRC engine, this color is used. It should be mapped as default-foreground (if used as fgcolor) or default-background (if used as bgcolor).
 
 Flags (used in setFlags):
 H: Present if the message is highlighted.
 M: Present if the message has been sent by the local user.
 
 Types (used in setFlags):
 ACTION - a /me message
 NORMAL - a normal message
 NOTICE - a notice
 TOPIC  - topic
 JOIN   - a join event
 PART   - a part event
 QUIT   - a quit event
 BAN    - a ban event
 KICK   - a kick event
 MODE   - a mode event
 ERROR  - an error event
 EXCEPTION - an exception event
 EVENT  - a generic event (e.g. disconnected, you parted from this channel, etc..)
 For links to be open, you should prefix each link with a "link:" prefix. E.g. http://google.com becomes link:http://google.com
 They will be open with an external application. 
 
 For further questions, contact the Relay team.
 -->
<html>
    <head>
		<meta name="viewport" content="width=device-width; initial-scale=1.0; maximum-scale=1.0; user-scalable=0;"/>
        <style>
            html, body { width:100%%; height:100%%;}
			.padd { height:4px; width:100%%;}
            body {
                font-family: "Helvetica Neue", Helvetica, Arial, "Lucida Grande", "HelveticaNeue-Light", "Helvetica Neue Light", sans-serif; 
                word-wrap: break-word;
                font-size: 12px;
				overflow:hidden;
            }
			a { color:#498adb;text-decoration:none;}
			a:active { color:#34629b; }
            * { padding: 0px; margin: 0px; }
            p {
				overflow:hidden;
				color:#c9c9ce;
				border-top-color:#c9c9ce;
				border-top-style:solid;
				border-top-width:1px;
				padding-right:5px;
				padding-left:5px;
                padding-top:2px;
				text-shadow: 0px 1px 0px #FFFFFF;
				-webkit-box-shadow: inset 0px 1px 1px 0px rgba(250, 251, 252, 1);
				padding-bottom:2px;
                background: -webkit-gradient(linear, left top, left bottom, color-stop(0%%,#eef2f5), color-stop(100%%,#edf2f4));
            }
            /*
             Nickname colors
             */
            .color0  { } /* reserved */
            .color1  { color: #ea584f; }
            .color2  { color: #a86775; }
            .color3  { color: #6796a8; }
            .color4  { color: #a89a67; }
            .color5  { color: #3e8682; }
            .color6  { color: #863e66; }
            .color7  { color: #66863e; }
            .color8  { color: #5e3e86; }
            .color9  { color: #865e3e; }
            .color10 { color: #3e4286; }
            .color11 { color: #4238e7; }
            .color12 { color: #4e53a9; }
            .color13 { color: #a94e53; }
            .color14 { color: #4e81a9; }
            .color15 { color: #4ea9a4; }
            .color16 { color: #a94e81; }
            .color17 { color: #bc6e9a; }
            .color18 { color: #9abc6e; }
            .color19 { color: #6e73bc; }
            .color20 { color: #95cc91; }
            .color21 { color: #9195cc; }
            .color22 { color: #91b3cc; }
            .color23 { color: #b3cc91; }
            .color24 { color: #3e6886; }
            .color25 { color: #86803e; }
            .color26 { color: #803e86; }
            .color27 { color: #44863e; }
            .color28 { color: #3e4486; }
            .color29 { color: #35595f; }
            .color30 { color: #96bdc5; }
            .color31 { color: #925168; }
            .color32 { color: #689251; }

            html {
                -webkit-text-size-adjust: none; /* Never autoresize text */
            }
		</style>
		<script>
            /* 
            These variables are not required by Relay. They are however used by this theme.
             */
            var cnt = 0;
            var nowrem = 0;
            var maxscrollback = 300;
            var flags = {};
            var types = {};
            var isBottom = true;
            
            /*
             createMessage() - REQUIRED BY RELAY
             Abstract:
                Creates a new message.
             Arguments:
                None.
             Return Value:
                Returns a "message name", which should be an unique identifier for the message. 
             */ 
            
            function createMessage() {
                if (cnt >= maxscrollback) {
                    nowrem++;
                    delete flags[nowrem];
                    delete types[nowrem];
                    var elem = document.getElementById('msg' + nowrem);
                    document.body.removeChild(elem);
                }
                cnt++;
                var newdiv = document.createElement('p');
                var divIdName = 'msg' + cnt;
                newdiv.setAttribute('id',divIdName);
                newdiv.style.height = "auto";
                newdiv.innerHTML = '';
                if ((document.documentElement.clientHeight) >= window.pageYOffset) {
					isBottom = true;
				} else {
                    isBottom = false;
                }
				var adiv = document.getElementById('chat');
				adiv.appendChild(newdiv);
                return cnt;
            }
            
            /*
             setFlags(name, type) - REQUIRED BY RELAY
                Abstract:
                    Sets message's flags.
                Arguments:
                    name: The message name (the return value of createMessage())
                    type: A string formatted this way: "FLAGS:TYPE". If there are no flags, the string is simply "TYPE".
                Additional Infos:
                    Currently used flags:
                        H: If the H flag is present, the message is an highlight. You should make it more recognizable or something like that.
                Return Value:
                    None.
             */ 
            
            function setFlags(name, type) {
                var olddiv = document.getElementById('msg' + name);
                var pos = type.indexOf(":");
                var lflags = "";
                if (pos != -1) {
                    lflags = type.substr(0,pos);
                    type = type.substr(pos+1);
                    /*
                     Flags are per-message metadata. (not per-chunk)
                     */
                    if (lflags.indexOf("M") != -1) {
                        //olddiv.style.background = "-webkit-gradient(linear, left top, left bottom, color-stop(0%,#edf6f9), color-stop(100%,#e7f1f6))";
						//olddiv.style.color = "#2d475c";
						//olddiv.style.borderTop = "solid #cedce4 1px";
						//olddiv.class = "mmf";
                    }
					else if (lflags.indexOf("H") != -1) {
						//     olddiv.style.background = "-webkit-gradient(linear, left top, left bottom, color-stop(0%,#f5f1f4), color-stop(100%,#f1ebef))";
						//	olddiv.style.borderTop = "solid #e2ced1 1px";
						olddiv.style.color = "#5b2e2e";
						olddiv.class = "hhf";
                    }
                }
				else {
					if (type == "TOPIC") {
						olddiv.style.textAlign="center";
					}
					else {
						olddiv.class="normal";
					}
				}
                types[name] = type;
                flags[name] = lflags;
            }
            /*
             addToMessage(name, isBold, isUnderlined, isItalic, bgcolor, fgcolor, text, isFirstChunk) - REQUIRED BY RELAY
                Abstract:
                    Adds a chunk to a message.
                Arguments:
                    name: The message's name (the return value of createMessage())
                    isBold: a string. If it's "YES", the chunk has the bold flag enabled
                    isUnderlined: a string. If it's "YES", the chunk has the underlined flag enabled
                    isItalic: a string. If it's "YES", the chunk has the italic flag enabled
                    bgcolor: The background color of the chunk. Unless changed using mIRC-like colors, it should be "default-foreground".
                    fgcolor: The background color of the chunk, as a string.
                    text: A string containing the text of the chunk.
                    isFirstChunk: Currently unused.
                    isNick: if the current chunk is a nickname. if so, it should be colored with a color identified by nickColor.
                    nickColor: a number that can go from 0 to 254 that represents an unique color. in the current implementation, only 32 colors are used. Color ID 1 is reserved for the current nickname (should have a particular color). Color ID 0 means there should be no color at all, but this is currently not used in Relay.
                Return Value:
                    Must be "SUCCESS". Everything else makes Relay think the message has not been rendered properly.
                
            */
            function addToMessage(name, isBold, isUnderlined, isItalic, bgcolor, fgcolor, text, isNick, nickColor) {
                if (types[name] == "EVENT") {
                    isBold = "YES";
                } else
                if (types[name] == "ERROR") {
                    isBold = "YES";
                }
                if (isNick == "YES") {
                    isBold = "YES";
                }
                var olddiv = document.getElementById('msg' + name);
				if (fgcolor == "default-foreground") {
					if (olddiv.class == "mmf") {
						fgcolor = "#2d475c";
					}
					else if (olddiv.class == "hhf") {
						fgcolor = "#5b2e2e";
					}
					else fgcolor = "#3e3f3f";
                }
                var pre = "";
                var post = "";
                var type = olddiv.type;
                if (isBold == "YES") {
                    pre += "<b>";
					post = "</b>" + post;
                }
                if (isUnderlined == "YES") {
                    pre += "<u>";
					post = "</u>" + post;
                }
                if (isItalic == "YES") {
                    pre += "<i>";
					post = "</i>" + post;
                } 
                if (isNick == "YES") {
                    pre += "<font color=\"" + fgcolor + "\" class=\"color" + nickColor + "\" style=\"background: " + bgcolor + ";\">"
                    post = "</font>" + post;
                } else {
                    pre += "<font color=\"" + fgcolor + "\" class=\"color0\" style=\"background: " + bgcolor + ";\">"
                    post = "</font>" + post;
                }
                olddiv.innerHTML += pre + text + post;
				scrollToBottom();
                return "SUCCESS";
            }

            /*
             scrollToBottom() - REQUIRED BY RELAY
                Abstract:
                    Scrolls to the bottom of the page.
                Arguments:
                    None.
                Return Value:
                    None.
             */
			
            function scrollToBottom() {
                window.scrollTo(0, document.body.scrollHeight);
                isBottom = true;
            }
            </script>
    </head>
    <body style="background-color: transparent;">
		<div id="chat">
		</div>
		<img class="padd" src="%@" />
    </body>
</html>